var gt=Object.defineProperty;var mt=(n,t,e)=>t in n?gt(n,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):n[t]=e;var u=(n,t,e)=>(mt(n,typeof t!="symbol"?t+"":t,e),e);import{d as j,c as z,r as H,o as S,_ as R,a as F,b as _,e as x,f as U,g as J,h as vt,i as kt,j as q,k as St,l as It,m as bt,n as wt,p as D,q as _t,s as N,t as w,w as E,F as P,u as p,v as lt,x as V,y as G,z as C,A as B,B as Y,C as yt,D as ct,E as L,G as dt,H as ht,I as pt,J as Ot,K as xt,L as Lt,M as Et,N as Nt,O as Ht,P as Dt,Q as Ct}from"./vendor.b40f5798.js";const Jt=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))a(i);new MutationObserver(i=>{for(const o of i)if(o.type==="childList")for(const s of o.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&a(s)}).observe(document,{childList:!0,subtree:!0});function e(i){const o={};return i.integrity&&(o.integrity=i.integrity),i.referrerpolicy&&(o.referrerPolicy=i.referrerpolicy),i.crossorigin==="use-credentials"?o.credentials="include":i.crossorigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function a(i){if(i.ep)return;i.ep=!0;const o=e(i);fetch(i.href,o)}};Jt();const zt=j({setup(n){return(t,e)=>{const a=H("router-view");return S(),z(a)}}});var k=(n=>(n[n.Linear=0]="Linear",n[n.InSine=1]="InSine",n[n.OutSine=2]="OutSine",n[n.InOutSine=3]="InOutSine",n[n.InQuad=4]="InQuad",n[n.OutQuad=5]="OutQuad",n[n.InOutQuad=6]="InOutQuad",n[n.InCubic=7]="InCubic",n[n.OutCubic=8]="OutCubic",n[n.InOutCubic=9]="InOutCubic",n[n.InQuart=10]="InQuart",n[n.OutQuart=11]="OutQuart",n[n.InOutQuart=12]="InOutQuart",n[n.InQuint=13]="InQuint",n[n.OutQuint=14]="OutQuint",n[n.InOutQuint=15]="InOutQuint",n[n.InExpo=16]="InExpo",n[n.OutExpo=17]="OutExpo",n[n.InOutExpo=18]="InOutExpo",n[n.InCirc=19]="InCirc",n[n.OutCirc=20]="OutCirc",n[n.InOutCirc=21]="InOutCirc",n[n.InElastic=22]="InElastic",n[n.OutElastic=23]="OutElastic",n[n.InOutElastic=24]="InOutElastic",n[n.InBack=25]="InBack",n[n.OutBack=26]="OutBack",n[n.InOutBack=27]="InOutBack",n[n.InBounce=28]="InBounce",n[n.OutBounce=29]="OutBounce",n[n.InOutBounce=30]="InOutBounce",n[n.Flash=31]="Flash",n[n.InFlash=32]="InFlash",n[n.OutFlash=33]="OutFlash",n[n.InOutFlash=34]="InOutFlash",n))(k||{});class b{static EaseInSine(t,e,a,i){function o(s){return 1-Math.cos(s*Math.PI/2)}return o(t/i)*(a-e)+e}static EaseInOutSine(t,e,a,i){function o(s){return-(Math.cos(Math.PI*s)-1)/2}return o(t/i)*(a-e)+e}static EaseOutSine(t,e,a,i){function o(s){return Math.sin(s*Math.PI/2)}return o(t/i)*(a-e)+e}static EaseInCubic(t,e,a,i){function o(s){return s*s*s}return o(t/i)*(a-e)+e}static EaseOutCubic(t,e,a,i){function o(s){return 1-Math.pow(1-s,3)}return o(t/i)*(a-e)+e}static EaseInOutCubic(t,e,a,i){function o(s){return s<.5?4*s*s*s:1-Math.pow(-2*s+2,3)/2}return o(t/i)*(a-e)+e}static EaseInQuart(t,e,a,i){function o(s){return s*s*s*s}return o(t/i)*(a-e)+e}static EaseOutQuart(t,e,a,i){function o(s){return 1-Math.pow(1-s,4)}return o(t/i)*(a-e)+e}static EaseInOutQuart(t,e,a,i){function o(s){return s<.5?8*s*s*s*s:1-Math.pow(-2*s+2,4)/2}return o(t/i)*(a-e)+e}}class Ft{constructor(){u(this,"tapNotes",[]);u(this,"holdNotes",[]);u(this,"dragNotes",[]);u(this,"flickNotes",[]);u(this,"numOfNotes",0)}addNoteActor(t){switch(this.numOfNotes++,t.noteData.type){case 1:this.tapNotes.push(t);break;case 2:this.holdNotes.push(t);break;case 3:this.dragNotes.push(t);break;case 4:this.flickNotes.push(t);break}}init(t){this.tapNotes.forEach(e=>{t.currentScene.add(e)}),this.holdNotes.forEach(e=>{t.currentScene.add(e)}),this.flickNotes.forEach(e=>{t.currentScene.add(e)}),this.dragNotes.forEach(e=>{t.currentScene.add(e)})}onNoteComplete(t){switch(t.active=!1,f.Instance.combo.value++,t.noteData.type){case 1:this.tapNotes.splice(this.tapNotes.indexOf(t),1);break;case 2:this.holdNotes.splice(this.holdNotes.indexOf(t),1);break;case 3:this.dragNotes.splice(this.dragNotes.indexOf(t),1);break;case 4:this.flickNotes.splice(this.flickNotes.indexOf(t),1);break}}}const $=class{};let y=$;u(y,"speedRatio",60),u(y,"tickSpeed",()=>10*120/$.speedRatio),u(y,"drawPosBlock",!0);class at extends R{constructor(t){super({height:3,width:3600,color:F.fromRGB(255,255,255,0),pos:_(0,-750)});u(this,"judgeLineData");u(this,"noteManager",new Ft);u(this,"speed",10);u(this,"posActor");this.judgeLineData=t,this.posActor=new R({pos:_(0,0),width:100,height:20,color:F.Azure})}onInitialize(t){super.onInitialize(t)}onPostUpdate(t,e){super.onPreUpdate(t,e),this.updateJudgeLine(t)}updateJudgeLine(t){f.Instance.isStarted&&(this.updateXY(),this.updateRotate(),this.updateAlpha(),this.drawNoteActors(),this.updateSpeed())}updateXY(){this.judgeLineData.moveXEvents.forEach(t=>{this.canUpdateEvent(t)&&(this.pos.x=this.doValueEase(t.event.easingType,f.Instance.getTime()-t.startTick,t.event.start,t.event.end,t.endTick-t.startTick))}),this.judgeLineData.moveYEvents.forEach(t=>{this.canUpdateEvent(t)&&(this.pos.y=-this.doValueEase(t.event.easingType,f.Instance.getTime()-t.startTick,t.event.start,t.event.end,t.endTick-t.startTick))})}updateRotate(){this.judgeLineData.rotateEvents.forEach(t=>{this.canUpdateEvent(t)&&(this.transform.rotation=this.doValueEase(t.event.easingType,f.Instance.getTime()-t.startTick,t.event.start,t.event.end,t.endTick-t.startTick)*(Math.PI/180))})}updateSpeed(){this.judgeLineData.speedEvents.forEach(t=>{this.canUpdateEvent(t)&&(this.speed=this.doValueEase(t.event.easingType,f.Instance.getTime()-t.startTick,t.event.start,t.event.end,t.endTick-t.startTick))})}updateAlpha(){this.judgeLineData.alphaEvents.forEach(t=>{if(this.canUpdateEvent(t)){let e=this.doValueEase(t.event.easingType,f.Instance.getTime()-t.startTick,t.event.start,t.event.end,t.endTick-t.startTick);this.color=F.fromRGB(255,255,255,e/255)}})}canUpdateEvent(t){return t.startTick<=f.Instance.getTime()&&t.endTick>=f.Instance.getTime()-5}doVectorEase(t,e,a,i,o){let s=e/60,r=o/60;switch(t){case k.Linear:return _(this.doValueEase(t,s,a.x,i.x,r),x.EasingFunctions.Linear(s,a.y,i.y,r));case k.InSine:return _(b.EaseInSine(s,a.x,i.x,r),b.EaseInSine(s,a.y,i.y,r));case k.OutSine:return _(b.EaseOutSine(s,a.x,i.x,r),b.EaseOutSine(s,a.y,i.y,r));case k.InOutSine:return _(b.EaseInOutSine(s,a.x,i.x,r),b.EaseInOutSine(s,a.y,i.y,r));case k.InQuad:return _(x.EasingFunctions.EaseInQuad(s,a.x,i.x,r),x.EasingFunctions.EaseInQuad(s,a.y,i.y,r));case k.OutQuad:return _(x.EasingFunctions.EaseOutQuad(s,a.x,i.x,r),x.EasingFunctions.EaseOutQuad(s,a.y,i.y,r));case k.InOutQuad:return _(x.EasingFunctions.EaseInOutQuad(s,a.x,i.x,r),x.EasingFunctions.EaseInOutQuad(s,a.y,i.y,r));default:return _(x.EasingFunctions.Linear(s,a.x,i.x,r),x.EasingFunctions.Linear(s,a.y,i.y,r))}}doValueEase(t,e,a,i,o){e>o&&(e=o);let s=e/y.speedRatio,r=o/y.speedRatio;switch(t){case k.Linear:return x.EasingFunctions.Linear(s,a,i,r);case k.InSine:return b.EaseInSine(s,a,i,r);case k.OutSine:return b.EaseOutSine(s,a,i,r);case k.InOutSine:return b.EaseInOutSine(s,a,i,r);case k.InQuad:return x.EasingFunctions.EaseInQuad(s,a,i,r);case k.OutQuad:return b.EaseOutQuart(s,a,i,r);case k.InOutQuad:return x.EasingFunctions.EaseInOutQuad(s,a,i,r);case k.InCubic:return b.EaseInCubic(s,a,i,r);case k.OutCubic:return b.EaseOutCubic(s,a,i,r);case k.InOutCubic:return b.EaseInOutCubic(s,a,i,r);case k.InQuart:return b.EaseInQuart(s,a,i,r);case k.OutQuart:return b.EaseOutQuart(s,a,i,r);case k.InOutQuart:return b.EaseInOutQuart(s,a,i,r);default:return x.EasingFunctions.Linear(s,a,i,r)}}drawNoteActors(){f.Instance.getTime()}}var Tt="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAA90AAABkCAYAAACb41OmAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAAEa8AABGvAff9S4QAAAzqSURBVHhe7d0/rF3VlcDhyLIobGniglDEojFFlFCa6YImTURSxgppTAmhJdJkpNCbaSLoIs+0oHROaegSOcRBgYwUyYCQcIHHFIEwCMke4byYO2t7bPOe33rv3T9nHW9tvp/0Fd4FmyPuLZbX5d6vLRaLav8SqvtdyO6eyneDJEmSJOnL2qyXzU9TuhAqK3+G9HBivw3VfS9kd0/lfJAkSZIkfVmb9bL5aUo/CJWVP0N6OKERttwngyRJkiRpd9UL0OatUFnpM6SHExphy30uSJIkSZJ2N8e2+1SorPQZ0sOJjLDl/na4GSRJkiRJedWL0EPhUqis7BnSw4mMsOV+OUiSJEmS9m6ObfdTobKyZ0gPJzDClvtE2AqSJEmSpP2rXogeDpdDZSXPkB5OYIQt99kgSZIkSTq4Obbdz4bKSp4hPdzQCFvub4YbQZIkSZK0XNWL0QfC1VDZ5M+QHm5ohC33i0GSJEmStHxzbLufC5VN/gzp4QZG2HI/GK4FSZIkSdJqVS9Ij4aPQ2WTPkN6uIERttxngiRJkiRp9ebYdj8fKpv0GdLDNY2w5T4WPg2SJEmSpPWqXpTOMbdN9gzp4ZpG2HL/IkiSJEmS1m+ObXf1J5Qne4b0cA0jbLmPhI+CJEmSJGmzqhem7bu4rofKJnmG9HANI2y5q78FT5IkSZK+Ks2x7X4pVDbJM6SHKxphyz3H771JkiRJ0lep6sXp8XAjVLbxM6SHKxphy/1MkCRJkiRN1xzb7rOhso2fIT1cwQhb7sPh/SBJkiRJmrbqBeojYStUttEzpIcrGGHLfTpIkiRJkqZvjm33K6GyjZ4hPVzSCFvuQ+FSkCRJkiTVVL1IfTTcDJWt/Qzp4ZJG2HL/KEiSJEmS6ppj230uVLb2M6SHSxhhy928GSRJkiRJtVUvVE+G6tZ6hvRwCSNsuZ8IkiRJkqT65th2vxYqW+sZ0sMDjLLlvhAkSZIkSfNUvVh9PFS38jOkhwcYYcs9x3+Mlbr42WJx5PcAAACba/NFh82x7a5erq78DOnhPkbZcp8PXfXk2/mbBQAAYFU/jvmi00b434hXeob0cB8jbLnn+B/sV+rd64vF0eSNAgAAsI42X7wTc0aHzbHtfitUttIzpId7GGXLXf1V8iv39Hv5GwUAAGBdbc7otOpF66lQ3dLPkB7uYYQt93dC9Y+mr9SVzxeLr7+ev0kAAADW1eaMNm90WPW2+1C4FCpb+hnSw8QoW+6XQ1f9/HL+BgEAANhUmzc6rXrhejpUt9QzpIeJEbbcJ8JW6Ka//X2xeOhi/uYAAADYVJs32tzRYdXb7sOh+q8clnqG9PAeo2y5z4aueuGD/I0BAAAwlTMxd3Ra9eL12VDdgc+QHt5jhC338XAjdNP1m4vFw2/kbwoAAICptLmjzR8dVr3tfiBcDZUd+Azp4TajbLlfDF31qw/zNwQAAMDU2vzRadUL2OdCdfs+Q3q4zQhb7gfDtdBNW18sFt/6U/5mAAAAmFqbP9oc0mHV2+4j4eNQ2b7PkB7eNsqW+0zoql//dfebAAAAoFKbQzqtehH7fKhuz2dID28bYct9LHwauqn95dI//1f+JgAAAKjS5pA+l93l2+455sI9nyE9DKNsuef4G42VevWT/A0AAABQrc0jnVa9kJ3jE9DpM+w6uG2ELXf77P5Hoau+/5fdL3wAAIA5tHmk06q33XN811f6DLsOwihb7jm+pW6l/vhZ/sIHAACYS5tLOq16MftSqG7XM+z4w20jbLnn+D22lXvy7fxFDwAAMJefvHN7QOmv6m338XAjVLbrGXb8IYyy5f5p6Kp3ry8WR5MXPAAAwJzaXNLmk06rXtCeDdXteIbtlzcjbLkPh/dDVz3zXv6CBwAAmFubTzqtett9ImyFynY8w/bLR9lynw5ddeXzxeLY6/mLHQAAYG5tPmlzSqdVL2pfCdXdfYbtF4+w5T4ULoWu+rfL+QsdAADgfmlzSqdVb7sfDTdDZXef4c6lo2y5T4Wu+mRrsXjoYv4iBwAAuF/anPI/1R+0Xr/qhe25UN2tZ7hz4Qhb7ubN0FUvfJC/wAEAAO63f79ye3Dpr+pt98lQ3a1naJeNsuV+InTV/95cLB5+I39xAwAA3G9tXmlzS6dVL25fDdV9r100ypb7QuiqX17JX9gAAAC9aHNLp1Vvux8P1f22XdS20NW1bfq9Dzi1/obu/85f1AAAAL1oc0unVX9i+ruhut+3i9oWurrqv6FofhC6ysfLAQCAnn3FP15+PlT3wzuXjfIR87dCV/kiNQAAoFcdf5Fa9ZZ7ji9Sa/Pp3W8vH2Xb7SfDAAAAltDmlDavdFr10naOnwxr8+ndobsZYdt9KFwKXdV+dD57kQMAANwvbU7ptOot97dD9Yfq3wltPt0xdI+y7X4qdNWVzxeLY6/nL3QAAIC5tfmkzSmdVr2sfTlU1+bSW/fde/kI2+7Dobu/s3n6vfzFDgAAMLdnYj7ptOot94lQ/aH6No+2ufTWnff+C4yy7X42dNW71xeLo8mLHQAAYE5tLmnzSadVL2nPhuraPHr3zu2X3zHCtvuBcDV01ZNv5y96AACAubS5pNOqt9zfDDdCZR+GNo/evXf7v8Ado2y7nwtd9cfP8hc9AADAXNpc0mnVy9kXQ3U/Czvu3fGHbUbYdh8NH4eu+v5f8hc+AABAtTaPdFr1lvvBcC1U1ubPNofuuHvHH7YZZdv9fOiq85/kL34AAIBqbR7ptOql7JlQXZs/d92962CbEbbdx8KnoZu+CI/9OX8DAAAAVGlzSJtHOqx6yz3HXNj++e2eXffvOthmlG33HH+jsVK//mv+JgAAAKjS5pBOq17G/iJU90LI7t536G5G2Ha3z+539YX4W18sFt/6U/5GAAAAmFqbP9oc0mHVW+4j4aNQWZs3vxGy+w8cukfZdr8UuupXH+5+IwAAAFRo80enVS9h5/hVqzZvZnffkh7eY4Rt9/FQ/XtsK3X95mLx8Bv5GwIAAGAqbe649o/bg0hfVW+52+9lXw2VtTmzzZvZ/bekh/cYZdt9NnTVmQ/yNwUAAMBU2tzRadXL12dCdf8ZsrvvSg8TI2y7HwlboZv+9vfF4qGL+RsDAABgU23eaHNHh1VvuQ+H90Nlbb5sc2Z2/13pYWKUbfcroat+fjl/cwAAAGzqX2Pe6LTqpevpUF2bL7O7d0gP9zDCtvvRcDN005XPF4uvv56/QQAAANb1TzFntHmjw6q33IfCpVBZmyvbfJndv0N6uIdRtt3nQlc9/V7+JgEAAFhXmzM6rXrZ+qNQ3W9Cdvcu6eE+Rth2nwxd9c71xeJo8iYBAABYR5sv2pzRYdVb7ubNUN1jIbt7l/RwH6Nsu18LXfXjt/M3CwAAwKrafNFp1UvWJ0J1bZ7M7k6lhwcYYdv9eOiqi5/lbxYAAIBV/SHmiw6bY8t9IVTX5sns7lR6eIBRtt1z/MeQJEmSJP1/IyxX2xyZ3b2n9HAJI2y75/jYgSRJkiRpni33+VDdD0N2957SwyWMsu1+K0iSJEmSaqteqs7xhdltfszu3ld6uKQRtt2ngiRJkiSprjm23HP8NHSbH7O795UeLmmEbfccP5ouSZIkSV/lqpep3wk3Q2Xt++Db/Jjdv6/0cAUjbLtPB0mSJEnS9M2x5X45VPdUyO4+UHq4ghG23YfD5SBJkiRJmrbqJeqJsBUqa/Nimxuz+w+UHq5ohG33s0GSJEmSNF1zbLnPhuravJjdvZT0cEUjbLsfCFeDJEmSJGmaqpenx8ONUFmbE9u8mN2/lPRwDSNsu58LkiRJkqTNm2PL/WKo7mchu3tp6eEaRth2HwkfB0mSJEnSZlUvTR8M10JlbT48GrL7l5YermmEbffzQZIkSZK0fnNsuc+E6tp8mN29kvRwTSNsu4+FT4MkSZIkab2ql6VzzG3tn9/uye5fSXq4gRG23XP8jYkkSZIkjdgcW+45PqHc5sLs7pWlhxsYYds9x/8bIEmSJEkjVr0kbd/F9VGo7Hr4RsjuX1l6uKERtt0vBUmSJEnS8s2x5Z7jV6faPJjdvZb0cEMjbLvn+L03SZIkSRqp6uVo+73s9rvZlbU5sM2D2f1rSQ8nMMK2+2yQJEmSJB3cHFvun4bq/iNkd68tPZzACNvuE2ErSJIkSZL2r3opeji8Hypr898jIbt/benhREbYdr8SJEmSJEl7N8eW+3Sors1/2d0bSQ8nMsK2+9FwM0iSJEmS8qqXoYfCpVBZm/va/Jfdv5H0cEIjbLvPBUmSJEnS7ubYcp8K1bW5L7t7Y+nhhEbYdp8MkiRJkqTdVS9BmzdDdY+F7O6NpYcTG2Hb/WqQJEmSJH3ZHFvuJ0J1r4Xs7kmkhxMbYdv9eJAkSZIkfdkcW+4Lobo272V3T2Dxtf8DnokbRyguRwsAAAAASUVORK5CYII=",Bt="/phisim-excalibur/assets/TapHL.4028b94c.png",jt="data:image/png;base64,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",Pt="/phisim-excalibur/assets/DragHL.8cd6465c.png",Xt="/phisim-excalibur/assets/Flick.2e8bf1f5.png",Qt="/phisim-excalibur/assets/FlickHL.0448d1f4.png",Rt="/phisim-excalibur/assets/Hold.d73a79ae.png",Vt="/phisim-excalibur/assets/click.a91b6df4.png",Zt="/phisim-excalibur/assets/HitSong0.602924a6.ogg",Mt="/phisim-excalibur/assets/HitSong1.177bdf34.ogg",Ut="/phisim-excalibur/assets/HitSong2.11e4b951.ogg";class h{}u(h,"HitSound",new U(Zt)),u(h,"HitSound_Drag",new U(Mt)),u(h,"HitSound_Flick",new U(Ut)),u(h,"Tap",new J(Tt)),u(h,"TapHl",new J(Bt)),u(h,"Drag",new J(jt)),u(h,"DragHl",new J(Pt)),u(h,"Flick",new J(Xt)),u(h,"FlickHl",new J(Qt)),u(h,"Hold",new J(Rt)),u(h,"Clicks",new J(Vt));class ft extends R{constructor(){super();u(this,"animation");u(this,"played");u(this,"emitter");let t=vt.fromImageSource({image:h.Clicks,grid:{rows:5,columns:6,spriteWidth:256,spriteHeight:256}});this.animation=kt.fromSpriteSheet(t,x.range(0,t.sprites.length-1),2,q.Freeze),this.graphics.use(this.animation),this.played=!1,this.color=F.Yellow}play(t=!1){this.animation.reset(),t?this.animation.strategy=q.Loop:(this.animation.strategy=q.End,this.played=!0),this.animation.play()}end(){var t;(t=this.emitter)==null||t.kill(),this.kill()}onPostUpdate(t,e){super.onPostUpdate(t,e),this.emitter&&(this.emitter.transform.pos=this.transform.pos),this.played&&this.animation.done&&this.end()}createEmitter(){let t=new St({height:200,width:200,startSize:50,endSize:50,minSize:50,maxSize:50});t.emitterType=It.Circle,t.radius=0,t.minVel=500,t.maxVel=500,t.minAngle=0,t.maxAngle=6.2,t.isEmitting=!0,t.emitRate=8,t.opacity=.8,t.fadeFlag=!0,t.particleLife=600,t.acceleration=new bt(10,10),t.beginColor=F.Yellow,t.endColor=F.Yellow,this.emitter=t,this.scene.add(this.emitter)}}class M extends R{constructor(t,e){super();u(this,"noteData");u(this,"lineData");this.pos.y=9e3,this.noteData=t,this.lineData=e,this.graphics.onPostDraw=a=>{Math.abs(this.transform.pos.y)<=900/2&&Math.abs(this.transform.pos.x)<=1350/2&&a.drawRectangle(_(0,0),20,20,F.Rose)}}onInitialize(t){super.onInitialize(t),this.graphics.use(this.normalSprite)}onPostUpdate(t,e){if(!f.Instance.isStarted)return;let a=this.getTick();this.drawNote(),this.noteData.startTick+y.speedRatio/15>=a&&this.noteData.startTick<=a&&this.onHit(),this.noteData.endTick<=f.Instance.getTime()-20&&!this.noteData.isFake&&this.onMiss()}onHit(){if(!this.noteData.isFake){this.hitSound.play(.6);let t=new ft;t.pos=this.pos,this.scene.add(t),t.play()}this.onComplete()}onMiss(){}onComplete(){f.Instance.judgeLineActors[this.noteData.index.judgeIndex].noteManager.onNoteComplete(this)}getDistance(){let t=f.Instance.judgeLineActors[this.noteData.index.judgeIndex],e=this.getTick();return(this.noteData.startTick-e)*y.tickSpeed()*(t.speed/10)}getDistance2(){let t=f.Instance.judgeLineActors[this.noteData.index.judgeIndex],e=this.getTick();return(this.noteData.startTick-e<=0?0:this.noteData.startTick-e)*y.tickSpeed()*(t.speed/10)}getPos(t){if(t<=-3e3||t>=3e3)return;let e=f.Instance.judgeLineActors[this.noteData.index.judgeIndex],a=e.transform.rotation,i=_(+Math.cos(a)*this.noteData.positionX,+Math.sin(a)*this.noteData.positionX),o=_(+Math.cos(Math.PI/2-a)*t,-Math.sin(Math.PI/2-a)*t),s=i.x+o.x,r=i.y+o.y;return _(Math.round(e.transform.pos.x+s),Math.round(e.transform.pos.y+r))}drawNote(){let t=this,e=f.Instance.judgeLineActors[this.noteData.index.judgeIndex],a=this.getPos(this.getDistance());a&&Math.abs(a.y)<=1500/2&&Math.abs(a.x)<=2e3/2&&(t.transform.pos.x=a.x,t.transform.pos.y=a.y,t.transform.rotation=e.transform.rotation)}getTick(){return f.Instance.getTime()}}class st extends M{constructor(t,e){super(t,e);u(this,"highLightSprite",h.TapHl.toSprite());u(this,"normalSprite");u(this,"hitSound",h.HitSound);this.normalSprite=h.Tap.toSprite(),this.normalSprite.height=20,this.normalSprite.width=197.8}onInitialize(t){super.onInitialize(t)}onPostUpdate(t,e){super.onPostUpdate(t,e)}}class ot extends M{constructor(t,e){super(t,e);u(this,"highLightSprite",h.TapHl.toSprite());u(this,"normalSprite");u(this,"hitSound",h.HitSound_Flick);this.normalSprite=h.Flick.toSprite(),this.normalSprite.height=40,this.normalSprite.width=197.8}onInitialize(t){super.onInitialize(t)}onNoteUpdate(){}}class rt extends M{constructor(t,e){super(t,e);u(this,"highLightSprite",h.TapHl.toSprite());u(this,"normalSprite");u(this,"hitSound",h.HitSound_Drag);this.normalSprite=h.Drag.toSprite(),this.normalSprite.height=12,this.normalSprite.width=197.5}onInitialize(t){super.onInitialize(t)}onNoteUpdate(){}}class ut extends M{constructor(t,e){super(t,e);u(this,"holding",!1);u(this,"click");u(this,"highLightSprite",h.TapHl.toSprite());u(this,"normalSprite");u(this,"hitSound",h.HitSound);this.normalSprite=h.Hold.toSprite(),this.normalSprite.width=197.5,this.normalSprite.height=(this.noteData.endTick-this.noteData.startTick)*y.tickSpeed()}onInitialize(t){super.onInitialize(t)}onNoteUpdate(){}getDistance(){let t=super.getDistance();return this.holding?this.normalSprite.height/2:t+this.normalSprite.height/2}getOriginPos(){return this.getPos(this.getDistance2())}onHit(){if(this.holding)return;this.hitSound.play(.6),this.holding=!0;let t=new ft;t.pos=this.getOriginPos(),this.scene.add(t),t.play(!0),this.click=t}onPreUpdate(t,e){var i;if(!f.Instance.isStarted)return;let a=f.Instance.getTime();if(super.onPreUpdate(t,e),this.holding&&a<=this.noteData.endTick+5&&(this.normalSprite.height=(this.noteData.endTick-a)*y.tickSpeed()),a>=this.noteData.endTick&&((i=this.click)==null||i.end(),this.onComplete()),this.click!=null)try{this.click.pos=this.getOriginPos()}catch{}}}class Z{static wait(t){return new Promise(e=>{setTimeout(()=>{e(0)},t)})}}u(Z,"mitt",wt());const T=class{constructor(t){u(this,"engine");u(this,"bgmBuffer");u(this,"combo",D(0));u(this,"soundHowl");u(this,"soundHowlId");u(this,"soundHowlDuration");u(this,"isStarted",!1);u(this,"judgeLineActors",[]);T.Instance=this,this.engine=t}async update(t,e){var a;this.isStarted&&this.getTimeNoTick()>=((a=this.soundHowlDuration)!=null?a:0)-1&&(this.isStarted=!1,T.endPlay().catch(i=>console.log(i)))}loadChartPhi(t){const e=(l,A)=>l/A*60/32*y.speedRatio,a=l=>l/7*675,i=l=>(l-.5)*900,o=l=>(l-.5)*1350;let s=JSON.parse(t),r=0;s.judgeLineList.forEach(l=>{let A=l.bpm,d={};d.moveXEvents=[],d.alphaEvents=[],d.moveYEvents=[],d.speedEvents=[],d.rotateEvents=[],l.judgeLineMoveEvents.forEach(g=>{d.moveXEvents.push({startTick:e(g.startTime,A),endTick:e(g.endTime,A),event:{linkgroup:0,start:o(g.start),end:o(g.end),easingType:0,startTime:[0,0,0],endTime:[0,0,0]}}),d.moveYEvents.push({startTick:e(g.startTime,A),endTick:e(g.endTime,A),event:{linkgroup:0,start:i(g.start2),end:i(g.end2),easingType:0,startTime:[0,0,0],endTime:[0,0,0]}})}),l.judgeLineRotateEvents.forEach(g=>{d.rotateEvents.push({startTick:e(g.startTime,A),endTick:e(g.endTime,A),event:{linkgroup:0,start:g.start,end:g.end,easingType:0,startTime:[0,0,0],endTime:[0,0,0]}})}),l.judgeLineDisappearEvents.forEach(g=>{d.alphaEvents.push({startTick:e(g.startTime,A),endTick:e(g.endTime,A),event:{linkgroup:0,start:g.start*255,end:g.end*255,easingType:0,startTime:[0,0,0],endTime:[0,0,0]}})});let c=new at(d),m=0;l.notesAbove.forEach(g=>{var X;let v={};v.type=g.type,v.above=1,v.isFake=!1,v.speed=1,v.positionX=a(g.positionX),v.index={judgeIndex:r,index:m},v.startTick=e(g.time,A),v.endTick=e(g.time+((X=g.holdTime)!=null?X:0),A),v.type==1?c.noteManager.addNoteActor(new st(v,d)):v.type==3?c.noteManager.addNoteActor(new ut(v,d)):v.type==2?c.noteManager.addNoteActor(new rt(v,d)):v.type==4&&c.noteManager.addNoteActor(new ot(v,d)),m++}),r++,T.Instance.judgeLineActors.push(c)}),this.judgeLineActors.forEach(l=>{this.engine.add(l),l.noteManager.init(this.engine),console.log(`PHIJSON:\u5224\u5B9A\u7EBF\u521D\u59CB\u5316...${l.noteManager.numOfNotes}`)})}loadChart(t,e){e=="rpe_json"&&this.loadChartRpe(JSON.parse(t)),e=="official_json"&&this.loadChartPhi(t)}loadChartRpe(t){const e=(i,o)=>{let s=0;return typeof i=="number"&&(s=i),i instanceof Array&&(s=i[0]+i[1]/i[2]),Math.round(s/o*60*y.speedRatio)};let a=0;t.judgeLineList.forEach(i=>{var A;let o=JSON.parse(JSON.stringify(i));o.moveXEvents=[],o.alphaEvents=[],o.moveYEvents=[],o.speedEvents=[],o.rotateEvents=[];let s=t.BPMList[0].bpm;i.eventLayers.forEach(d=>{let c=t.BPMList[0].bpm;d.moveXEvents.forEach(m=>{o.moveXEvents.push({startTick:e(m.startTime,c),endTick:e(m.endTime,c),event:m})}),d.moveYEvents.forEach(m=>{o.moveYEvents.push({startTick:e(m.startTime,c),endTick:e(m.endTime,c),event:m})}),d.alphaEvents.forEach(m=>{o.alphaEvents.push({startTick:e(m.startTime,c),endTick:e(m.endTime,c),event:m})}),d.rotateEvents.forEach(m=>{o.rotateEvents.push({startTick:e(m.startTime,c),endTick:e(m.endTime,c),event:m})}),d.speedEvents.forEach(m=>{o.speedEvents.push({startTick:e(m.startTime,c),endTick:e(m.endTime,c),event:m})})}),o.eventLayers=[];let r=new at(o);T.Instance.judgeLineActors.push(r);let l=0;(A=i.notes)==null||A.forEach(d=>{let c=d;c.index={judgeIndex:a,index:l},c.startTick=e(d.startTime,s),c.endTick=e(d.endTime,s),c.type==1?r.noteManager.addNoteActor(new st(c,o)):c.type==2?r.noteManager.addNoteActor(new ut(c,o)):c.type==4?r.noteManager.addNoteActor(new rt(c,o)):c.type==3&&r.noteManager.addNoteActor(new ot(c,o)),l++}),a++}),console.log(`lines:${T.Instance.judgeLineActors.length}`),this.judgeLineActors.forEach(i=>{this.engine.add(i),i.noteManager.init(this.engine)}),console.info("JudgeLine\u521D\u59CB\u5316\u5B8C\u6210,NOTES INIT")}async loadBgm(t){function e(i){for(var o="",s=new Uint8Array(i),r=s.byteLength,l=0;l<r;l++)o+=String.fromCharCode(s[l]);return window.btoa(o)}let a=["data:audio/mp3;base64,"+e(t)];this.soundHowl=new _t.Howl({src:a})}async playBgm(){this.soundHowlId=this.soundHowl.play(),this.soundHowl.on("play",()=>{this.soundHowlDuration=this.soundHowl.duration(this.soundHowlId),this.isStarted=!0,console.log(this.soundHowlDuration)})}async start(){await this.playBgm()}getTime(){return this.soundHowl.seek(this.soundHowlId)*y.speedRatio}getTimeNoTick(){return this.soundHowl.seek(this.soundHowlId)}static async endPlay(){await Z.wait(5e3),Z.mitt.emit("playEnd")}};let f=T;u(f,"Instance");const qt=j({setup(n){return(t,e)=>null}}),Yt=lt("Load"),Gt=lt("Play"),Wt=j({setup(n){const t=D(void 0),e=D(void 0),a=async r=>{t.value=r.target.files[0]},i=r=>{e.value=r.target.files[0]},o=()=>{f.Instance.start()},s=async()=>{var A,d;let l=JSON.parse(await((A=t.value)==null?void 0:A.text()));console.log(l),f.Instance.loadChart(l),console.log("OK"),await f.Instance.loadBgm(await((d=e.value)==null?void 0:d.arrayBuffer())),console.log("BGM OK")};return(r,l)=>{const A=H("el-form-item"),d=H("el-form"),c=H("el-divider"),m=H("el-button");return S(),N(P,null,[w(d,null,{default:E(()=>[w(A,{label:"JSON\u6587\u4EF6"},{default:E(()=>[p("input",{type:"file",placeholder:"\u4E0A\u4F20JSON",id:"upload-json",name:"upload-json",onChange:l[0]||(l[0]=g=>a(g))},null,32)]),_:1}),w(A,{label:"\u97F3\u9891\u6587\u4EF6"},{default:E(()=>[p("input",{type:"file",id:"upload-bgm",name:"upload-bgm",onChange:l[1]||(l[1]=g=>i(g))},null,32)]),_:1})]),_:1}),w(c),w(m,{onClick:s},{default:E(()=>[Yt]),_:1}),w(m,{onClick:o,class:"success"},{default:E(()=>[Gt]),_:1}),w(qt)],64)}}}),tt=class{static set(t){tt.difficulty.value=t}};let I=tt;u(I,"difficulty",D("EZ")),u(I,"data2play",{illustration:"",json:void 0,music:void 0,chartInfo:void 0});const Kt={style:{left:"10%",height:"60%","font-size":"3.2vw"}},$t={class:"n2"},te=p("div",{class:"back"},null,-1),ee={class:"info"},ie={style:{height:"60%","font-size":"3.2vw"}},ne={style:{height:"40%","font-size":"1.4vw",display:"flex","align-items":"center"}},ae={class:"level",style:{opacity:"0.9"}},se={class:"y-flex",style:{transform:"skew(15deg)",height:"100%",width:"100%"}},oe={style:{height:"60%","font-size":"3.2vw",display:"flex","align-items":"end"}},re={style:{height:"40%","font-size":"1.8vw",display:"flex","align-items":"start"}},ue=j({props:{songInfo:null,isSelected:{type:Boolean,default:!1}},emits:["selected"],setup(n,{emit:t}){const e=n,a=I.difficulty;return(i,o)=>{var s;return S(),N(P,null,[V(p("div",{class:"n1",onClick:o[0]||(o[0]=r=>{t("selected",e.songInfo)})},[p("div",Kt,C(n.songInfo.name),1)],512),[[G,!n.isSelected]]),V(p("div",$t,[te,p("div",ee,[p("div",ie,C(n.songInfo.name),1),p("div",ne,C(n.songInfo.artist),1)]),p("div",ae,[p("div",se,[p("div",oe,C((s=n.songInfo[B(a).toLowerCase()+"Ranking"])!=null?s:"?"),1),p("div",re,C(B(a)),1)])])],512),[[G,n.isSelected]])],64)}}});var W=(n,t)=>{const e=n.__vccOpts||n;for(const[a,i]of t)e[a]=i;return e};const le=j({props:{value:null,difficulty:null},setup(n){const t=n,e=I.difficulty,a=()=>{I.set(t.difficulty)},i=()=>{switch(t.difficulty){case"EZ":return"limegreen";case"HD":return"dodgerblue";case"IN":return"red";case"AT":return"#795d5d";case"SP":return"linear-gradient(blue, slateblue, coral, lightpink)"}};return(o,s)=>(S(),N(P,null,[V(p("div",{class:"red",style:Y({background:i()})},null,4),[[G,B(e)===n.difficulty]]),p("div",{class:"c",onClick:s[0]||(s[0]=r=>{a()})},[p("div",{style:Y({"font-size":"3vw",color:B(e)===n.difficulty?"white":"black"})},C(n.value),5),p("div",{style:Y({"font-size":"1vw",color:B(e)===n.difficulty?"white":"black"})},C(n.difficulty),5)])],64))}});var Q=W(le,[["__scopeId","data-v-08322da2"]]);class ce{constructor(t){u(this,"_api");u(this,"axios");u(this,"charts",[]);this._api=t,this.axios=yt.create({baseURL:t})}async getChartList(){return(await this.axios("/list.json")).data}async init(){let t=await this.getChartList();for(const e of t)this.charts.push(await this.getChartInfo(e.name))}async getChartInfo(t){return(await this.axios(`/${t}/meta.json`)).data}async getChartJson(t,e){return(await this.axios(`/${t}/Chart_${e}.json`)).data}getChartIllustrationUrl(t){return this._api+`/${t.codename}/${t.illustration}`}async getChartMusicData(t){return(await this.axios.get(`/${t.codename}/${t.musicFile}`,{responseType:"arraybuffer"})).data}}const K=n=>(dt("data-v-5c6af3c0"),n=n(),ht(),n),de={key:0,style:{height:"100%",width:"100%",position:"fixed",overflow:"hidden"}},he={id:"backgroundImg",style:{height:"100%",width:"100%"}},pe={id:"listPanel"},fe={class:"song-item"},Ae=K(()=>p("div",{style:{"z-index":"1",height:"100%",width:"90%",background:"#3f3f3fCC",position:"absolute"}},null,-1)),ge={key:0,id:"illustrationPanel",style:{position:"fixed",left:"50%",top:"10%",height:"70%",width:"42%",transform:"skew(-15deg)"}},me={style:{height:"75%","overflow-x":"hidden","overflow-y":"hidden","box-shadow":"0 0 10px 0 #7c7c7c"}},ve=K(()=>p("div",{style:{height:"10%"}},null,-1)),ke={style:{height:"15%"}},Se={id:"infoBar"},Ie={style:{height:"100%",width:"80%"}},be=K(()=>p("svg",{style:{"margin-left":"15%"},t:"1648635290592",class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"2336",height:"60%"},[p("path",{d:"M213.333333 65.386667a85.333333 85.333333 0 0 1 43.904 12.16L859.370667 438.826667a85.333333 85.333333 0 0 1 0 146.346666L257.237333 946.453333A85.333333 85.333333 0 0 1 128 873.28V150.72a85.333333 85.333333 0 0 1 85.333333-85.333333z m0 64a21.333333 21.333333 0 0 0-21.184 18.837333L192 150.72v722.56a21.333333 21.333333 0 0 0 30.101333 19.456l2.197334-1.152L826.453333 530.282667a21.333333 21.333333 0 0 0 2.048-35.178667l-2.048-1.386667L224.298667 132.416A21.333333 21.333333 0 0 0 213.333333 129.386667z",fill:"#333333","p-id":"2337"})],-1)),we=[be],_e={key:1,style:{position:"fixed",height:"100%",width:"200%"}},ye=j({setup(n){const t=D(!1);D("");const e=pt(),a=D(void 0),i=D(new ce("http://server2.heerdev.top/charts"));ct(async()=>{await i.value.init(),t.value=!0,a.value=i.value.charts[0]});const o=r=>{a.value=r,console.log("info\u88AB\u9009\u62E9"),console.log(r)},s=async()=>{var l;let r=I.difficulty.value;if(r==null){alert("\u4F60\u8FD8\u6CA1\u6709\u9009\u62E9\u96BE\u5EA6\u3002");return}try{I.data2play.chartInfo=a.value,I.data2play.json=JSON.stringify(await i.value.getChartJson((l=a.value)==null?void 0:l.codename,r)),console.log("\u8FDC\u7A0Bjson\u8BFB\u53D6\u5B8C\u6210"),I.data2play.music=await i.value.getChartMusicData(a.value),I.data2play.illustration=i.value.getChartIllustrationUrl(a.value),console.log("\u8FDC\u7A0B\u97F3\u9891arrayBuffer\u8BFB\u53D6\u5B8C\u6210"),await e.push({path:"/play"})}catch{alert("\u51FA\u73B0\u9519\u8BEF!\u53EF\u80FD\u662F\u96BE\u5EA6\u9009\u62E9\u9519\u8BEF\uFF0C\u6216\u8005\u662F\u8C31\u9762JSON\u4E0E\u97F3\u9891/\u56FE\u7247\u8BFB\u53D6\u51FA\u9519\u3002")}};return(r,l)=>{const A=H("el-image"),d=H("el-scrollbar"),c=H("el-col"),m=H("el-row"),g=Ot("loading");return S(),N(P,null,[t.value?(S(),N("div",de,[p("div",he,[a.value!==void 0?(S(),z(A,{key:0,style:{height:"100%",width:"100%",filter:"blur(8px)"},src:i.value.getChartIllustrationUrl(a.value),fit:"cover"},null,8,["src"])):L("",!0)]),p("div",pe,[w(d,{style:{background:"transparent",position:"absolute",width:"100%"}},{default:E(()=>[(S(!0),N(P,null,xt(i.value.charts,v=>(S(),N("div",fe,[w(ue,{onSelected:o,"is-selected":a.value===v,"song-info":v},null,8,["is-selected","song-info"])]))),256))]),_:1}),Ae]),a.value!==void 0?(S(),N("div",ge,[p("div",me,[a.value!==void 0?(S(),z(A,{key:0,style:{height:"100%",width:"120%",left:"-10%",transform:"skew(15deg)"},src:i.value.getChartIllustrationUrl(a.value),fit:"cover"},null,8,["src"])):L("",!0)]),ve,p("div",ke,[p("div",Se,[p("div",Ie,[w(m,{id:"infoBarDifRow",gutter:0},{default:E(()=>{var v,X,et,it,nt;return[((v=a.value)==null?void 0:v.ezRanking)!==void 0?(S(),z(c,{key:0,span:4},{default:E(()=>{var O;return[w(Q,{value:(O=a.value)==null?void 0:O.ezRanking,difficulty:"EZ"},null,8,["value"])]}),_:1})):L("",!0),((X=a.value)==null?void 0:X.hdRanking)!==void 0?(S(),z(c,{key:1,span:4},{default:E(()=>{var O;return[w(Q,{value:(O=a.value)==null?void 0:O.hdRanking,difficulty:"HD"},null,8,["value"])]}),_:1})):L("",!0),((et=a.value)==null?void 0:et.inRanking)!==void 0?(S(),z(c,{key:2,span:4},{default:E(()=>{var O;return[w(Q,{value:(O=a.value)==null?void 0:O.inRanking,difficulty:"IN"},null,8,["value"])]}),_:1})):L("",!0),((it=a.value)==null?void 0:it.atRanking)!==void 0?(S(),z(c,{key:3,span:4},{default:E(()=>{var O;return[w(Q,{value:(O=a.value)==null?void 0:O.atRanking,difficulty:"AT"},null,8,["value"])]}),_:1})):L("",!0),((nt=a.value)==null?void 0:nt.spRanking)!==void 0?(S(),z(c,{key:4,span:4},{default:E(()=>{var O;return[w(Q,{value:(O=a.value)==null?void 0:O.spRanking,difficulty:"SP"},null,8,["value"])]}),_:1})):L("",!0)]}),_:1})])])])])):L("",!0),p("div",{id:"startBtn",onClick:s},we)])):L("",!0),t.value?L("",!0):V((S(),N("div",_e,null,512)),[[g,!0]])],64)}}});var Oe=W(ye,[["__scopeId","data-v-5c6af3c0"]]);const At=n=>(dt("data-v-3e71640c"),n=n(),ht(),n),xe={key:0,class:"combo"},Le={style:{"font-size":"2.6vw"}},Ee=At(()=>p("span",{style:{"font-size":"0.8vw"}},"Combo(Auto)",-1)),Ne={key:1,style:{"z-index":"99","align-items":"center",position:"fixed",bottom:"1%",right:"1%","font-weight":"lighter",color:"white"}},He=At(()=>p("span",{style:{"font-size":"3vmin"}},"Phi-Sim-Excalibur-Viewer",-1)),De=[He],Ce={class:"fps"},Je=j({setup(n){const t=D(!0),e=D(0),a=pt();return Z.mitt.on("playEnd",()=>{document.getElementsByTagName("canvas")[0].remove(),a.push({path:"/list"})}),ct(async()=>{var s,r,l;if(I.data2play.json==null||I.data2play.music==null)return(s=document.getElementsByTagName("canvas")[0])==null||s.remove(),a.push({path:"/list"});const i=new Lt({resolution:{height:900,width:1350},maxFps:y.speedRatio,displayMode:Et.FillScreen,backgroundColor:F.Transparent});new f(i),i.on("initialize",A=>{A.target.currentScene.camera.pos=_(0,0),i.currentScene.camera.zoom=Math.min(i.drawHeight/900,i.drawWidth/1350)}),i.on("postupdate",A=>{f.Instance.update(A.engine,A.delta),e.value=Math.round(1e3/A.delta)}),await i.load(h.Tap),await i.load(h.Hold),await i.load(h.Drag),await i.load(h.Flick),await i.load(h.Clicks),await i.load(h.HitSound),await i.load(h.HitSound_Drag),await i.load(h.HitSound_Flick),await i.start();let o=I.data2play.json;f.Instance.loadChart(o,(l=(r=I.data2play.chartInfo)==null?void 0:r.formatter)!=null?l:"rpe_json"),await f.Instance.loadBgm(I.data2play.music),t.value=!1,f.Instance.start()}),(i,o)=>{const s=H("el-image");return S(),N(P,null,[t.value?L("",!0):(S(),N("div",xe,[p("span",Le,C(B(f).Instance.combo),1),Ee])),t.value?L("",!0):(S(),N("div",Ne,De)),p("div",Ce,"FPS:"+C(e.value),1),w(s,{style:{"z-index":"-99",width:"100%",height:"100%",position:"fixed",filter:"blur(50px)"},src:B(I).data2play.illustration,fit:"cover"},null,8,["src"])],64)}}});var ze=W(Je,[["__scopeId","data-v-3e71640c"]]);const Fe=[{path:"/",component:Wt},{path:"/list",component:Oe},{path:"/play",name:"play",component:ze}],Te=Nt({history:Ht(),routes:Fe});Dt(zt).use(Ct).use(Te).mount("#app");
